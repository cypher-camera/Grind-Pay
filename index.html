<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StartupPlatform Pro</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #5a7bff;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --warning: #f72585;
            --error: #ff5252;
            --light: #0f0f13;
            --dark: #ffffff;
            --gray: #a0a0a0;
            --light-gray: #252525;
            --card-bg: rgba(30, 30, 40, 0.7);
            --header-bg: rgba(15, 15, 25, 0.85);
            --input-bg: rgba(40, 40, 55, 0.5);
            --border-color: rgba(255, 255, 255, 0.1);
            --hover-bg: rgba(255, 255, 255, 0.05);
            --phoenix: linear-gradient(45deg, #ff7b00, #ff5252);
            --gold: linear-gradient(45deg, #ffd700, #ffb700);
            --neon-blue: #00d2ff;
            --neon-purple: #b400ff;
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            background: radial-gradient(ellipse at top, #1a1a2e, #0f0f1a);
            position: relative;
            font-family: 'Poppins', sans-serif;
        }

        /* Particle background */
        #particles-js {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
        }

        /* Modern Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Redesign */
        header {
            background-color: var(--header-bg);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border-color);
            animation: slideDown 0.5s ease-out;
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 28px;
            font-weight: 800;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            background: var(--gold);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -1px;
            text-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);
        }

        .logo::before {
            content: "â†»";
            font-size: 32px;
            background: var(--gold);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: rotate 8s linear infinite;
            filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.3));
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 15px;
        }

        nav a {
            text-decoration: none;
            color: var(--gray);
            font-weight: 500;
            padding: 8px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
            font-size: 16px;
            backdrop-filter: blur(5px);
        }

        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width 0.3s ease;
        }

        nav a:hover, nav a.active {
            color: var(--dark);
            background: rgba(67, 97, 238, 0.1);
        }

        nav a:hover::after, nav a.active::after {
            width: 100%;
        }

        nav a i {
            font-size: 18px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-type {
            background: var(--gold);
            color: #000;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            box-shadow: 0 4px 10px rgba(255, 215, 0, 0.2);
        }

        /* Modern Buttons */
        .btn {
            padding: 12px 24px;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transform: translateY(0);
            font-family: 'Poppins', sans-serif;
            letter-spacing: 0.5px;
            backdrop-filter: blur(5px);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .btn:active {
            transform: translateY(1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--dark);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: var(--dark);
        }

        .btn-founder {
            background: linear-gradient(135deg, #ff6b6b, #ff5252);
            color: var(--dark);
        }

        .btn-investor {
            background: linear-gradient(135deg, #48c6ef, #36aee0);
            color: var(--dark);
        }

        .btn-glow {
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            from {
                box-shadow: 0 0 5px -5px var(--primary);
            }
            to {
                box-shadow: 0 0 15px 2px var(--primary);
            }
        }

        /* Section Management */
        .section {
            padding: 40px 0;
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        /* Modern Cards */
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: var(--glass-shadow);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--glass-border);
            position: relative;
            overflow: hidden;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            animation: float 6s ease-in-out infinite;
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
        }

        .card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(to bottom, var(--neon-purple), var(--neon-blue));
        }

        .card::after {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            transform: rotate(30deg);
            pointer-events: none;
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0px); }
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .card-title {
            font-size: 26px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 700;
            text-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .card-title i {
            background: var(--gold);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 28px;
        }

        /* Forms */
        .form-group {
            margin-bottom: 25px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: var(--gray);
            font-size: 16px;
        }

        .form-control {
            width: 100%;
            padding: 16px;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            font-size: 16px;
            color: var(--dark);
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            backdrop-filter: blur(5px);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
            background-color: rgba(50, 50, 70, 0.7);
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        @media (min-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Video Container */
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 */
            height: 0;
            overflow: hidden;
            border-radius: 16px;
            margin-top: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            transform: perspective(1000px) rotateX(0deg);
            transition: transform 0.5s ease;
            overflow: hidden;
        }

        .video-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(179, 0, 255, 0.1), rgba(0, 210, 255, 0.1));
            z-index: 1;
            pointer-events: none;
        }

        .video-container:hover {
            transform: perspective(1000px) rotateX(5deg);
            box-shadow: 0 15px 30px rgba(0,0,0,0.4);
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 16px;
            z-index: 2;
        }

        /* User Lists */
        .user-list {
            list-style: none;
            max-height: 500px;
            overflow-y: auto;
            border-radius: 12px;
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            backdrop-filter: blur(5px);
        }

        .user-item {
            padding: 18px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            animation: slideInLeft 0.5s ease-out;
            backdrop-filter: blur(5px);
        }

        .user-item:hover {
            background-color: var(--hover-bg);
            transform: translateX(5px);
        }

        /* Posts */
        .post {
            padding: 25px;
            border-bottom: 1px solid var(--border-color);
            transition: all 0.3s ease;
            animation: fadeInUp 0.5s ease-out;
            border-radius: 16px;
            background: rgba(255,255,255,0.05);
            margin-bottom: 20px;
            backdrop-filter: blur(5px);
            position: relative;
            overflow: hidden;
        }

        .post::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(to bottom, var(--neon-purple), var(--neon-blue));
        }

        .post:hover {
            background-color: var(--hover-bg);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        .post-title {
            font-size: 24px;
            margin-bottom: 15px;
            color: var(--dark);
            font-weight: 700;
            text-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .post-author {
            font-size: 15px;
            color: var(--gray);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .post-author i {
            color: var(--primary);
        }

        .post-content {
            line-height: 1.8;
            color: var(--dark);
            font-size: 17px;
        }

        /* Search Bar */
        .search-bar {
            margin-bottom: 30px;
            display: flex;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
            backdrop-filter: blur(5px);
        }

        .search-bar input {
            flex-grow: 1;
            padding: 16px;
            background-color: var(--input-bg);
            border: none;
            color: var(--dark);
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .search-bar input:focus {
            background-color: rgba(50, 50, 70, 0.7);
        }

        .search-bar button {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 0 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 16px;
        }

        .search-bar button:hover {
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            padding: 0 35px;
        }

        /* Notices */
        .notice {
            background: linear-gradient(135deg, rgba(67, 97, 238, 0.1), rgba(63, 55, 201, 0.1));
            padding: 25px;
            border-radius: 16px;
            margin-bottom: 30px;
            border-left: 5px solid var(--primary);
            position: relative;
            overflow: hidden;
            animation: pulse 2s infinite, float 8s ease-in-out infinite;
            backdrop-filter: blur(5px);
        }

        .notice p {
            font-size: 18px;
            font-weight: 500;
        }

        /* Messages */
        .message-bubble {
            padding: 18px 25px;
            border-radius: 24px;
            max-width: 80%;
            position: relative;
            animation: fadeIn 0.4s ease-out;
            transition: transform 0.3s ease;
            margin-bottom: 20px;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .message-bubble:hover {
            transform: scale(1.03);
        }

        .sent-message {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 8px;
        }

        .received-message {
            background: linear-gradient(135deg, #2a2a2a, #333);
            color: var(--dark);
            margin-right: auto;
            border-bottom-left-radius: 8px;
        }

        /* User Cards */
        .user-card {
            padding: 25px;
            border: 1px solid var(--border-color);
            border-radius: 20px;
            margin-bottom: 25px;
            background: var(--card-bg);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            animation: float 8s ease-in-out infinite;
        }

        .user-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        .user-card-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        /* Avatar */
        .avatar {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: var(--gold);
            color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 24px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.15);
        }

        /* Message Input */
        .message-input-container {
            display: flex;
            gap: 20px;
            margin-top: 25px;
            animation: slideUp 0.4s ease-out;
        }

        .message-input {
            flex: 1;
            padding: 16px;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            color: var(--dark);
            transition: all 0.3s ease;
            font-size: 16px;
            backdrop-filter: blur(5px);
        }

        .send-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 16px;
            padding: 16px 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            min-width: 120px;
            font-size: 16px;
        }

        /* DM Styles */
        .dm-list {
            max-height: 500px;
            overflow-y: auto;
            border-radius: 16px;
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
            backdrop-filter: blur(5px);
        }

        .dm-item {
            padding: 18px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 20px;
            animation: slideInLeft 0.4s ease-out;
            backdrop-filter: blur(5px);
        }

        .dm-item:hover {
            background-color: var(--hover-bg);
            transform: translateX(5px);
        }

        .dm-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-height: 500px;
            overflow-y: auto;
            padding: 25px;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            margin-top: 25px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
            backdrop-filter: blur(5px);
        }

        /* Cash Management */
        .cash-actions {
            display: flex;
            gap: 25px;
            margin-top: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .cash-actions .btn {
            flex: 1;
            min-width: 180px;
            text-align: center;
            font-size: 16px;
            padding: 16px;
        }

        /* Mobile Navigation */
        .mobile-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--header-bg);
            border-top: 1px solid var(--border-color);
            padding: 15px 0;
            z-index: 100;
            backdrop-filter: blur(12px);
        }

        .mobile-nav ul {
            display: flex;
            justify-content: space-around;
            list-style: none;
        }

        .mobile-nav a {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: var(--gray);
            font-size: 14px;
            transition: color 0.3s;
            padding: 8px 15px;
            border-radius: 12px;
            backdrop-filter: blur(5px);
        }

        .mobile-nav a.active {
            color: var(--primary);
            background: rgba(67, 97, 238, 0.1);
        }

        .mobile-nav i {
            font-size: 24px;
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            .desktop-nav {
                display: none;
            }
            
            .mobile-nav {
                display: block;
            }
            
            .user-info .btn-outline {
                padding: 10px 18px;
                font-size: 14px;
            }
            
            .cash-actions {
                flex-direction: column;
            }
        }

        /* Responsive Adjustments */
        @media (max-width: 576px) {
            .user-info .btn-outline {
                display: none;
            }
            
            .logo {
                font-size: 22px;
            }
            
            .card {
                padding: 20px;
            }
        }

        /* Keyframes */
        @keyframes slideDown {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(0); }
        }

        @keyframes slideInLeft {
            0% { transform: translateX(-20px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }

        @keyframes fadeInUp {
            0% { transform: translateY(20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(67, 97, 238, 0.3); }
            70% { box-shadow: 0 0 0 15px rgba(67, 97, 238, 0); }
            100% { box-shadow: 0 0 0 0 rgba(67, 97, 238, 0); }
        }

        @keyframes slideUp {
            0% { transform: translateY(20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        /* Utility Classes */
        .hidden {
            display: none;
        }

        .mt-4 {
            margin-top: 1.5rem;
        }

        .text-muted {
            color: var(--gray);
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--input-bg);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, var(--neon-purple), var(--neon-blue));
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
        }

        /* Modern Auth Form */
        .auth-card {
            max-width: 500px;
            margin: 50px auto;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            animation: float 8s ease-in-out infinite;
        }

        .auth-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 30px;
            text-align: center;
        }

        .auth-body {
            padding: 35px;
        }

        .auth-footer {
            padding: 25px;
            text-align: center;
            background: rgba(255,255,255,0.03);
            border-top: 1px solid var(--border-color);
        }

        .auth-toggle {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
        }

        .auth-toggle:hover {
            text-decoration: underline;
            color: var(--primary-light);
        }

        /* Modern Dashboard */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        @media (min-width: 992px) {
            .dashboard-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .right-column {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        /* Modern Cash Section */
        .balance-display {
            font-size: 4rem;
            font-weight: 800;
            text-align: center;
            margin: 40px 0;
            background: var(--gold);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
            text-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
            animation: glow 2s infinite alternate;
        }

        .transaction-history {
            margin-top: 40px;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            transition: background 0.3s;
            backdrop-filter: blur(5px);
        }

        .transaction-item:hover {
            background: rgba(255,255,255,0.05);
            transform: translateX(5px);
        }

        .transaction-positive {
            color: #4ade80;
            font-weight: 600;
            text-shadow: 0 0 8px rgba(74, 222, 128, 0.3);
        }

        .transaction-negative {
            color: #f87171;
            font-weight: 600;
            text-shadow: 0 0 8px rgba(248, 113, 113, 0.3);
        }

        /* Modern DM Section */
        .dm-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        @media (min-width: 768px) {
            .dm-container {
                grid-template-columns: 30% 70%;
            }
        }

        /* Modern Networking Section */
        .networking-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
        }

        .user-card {
            display: flex;
            flex-direction: column;
        }

        .user-card-actions {
            margin-top: auto;
            padding-top: 20px;
        }

        /* Hero Text */
        .hero-text {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInUp 1s ease-out;
        }

        .hero-text h2 {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(45deg, var(--neon-blue), var(--neon-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            text-shadow: 0 4px 15px rgba(0, 210, 255, 0.2);
        }

        .hero-text p {
            font-size: 1.5rem;
            color: var(--gray);
            max-width: 800px;
            margin: 0 auto;
        }
           .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(10px);
    }
    
    .modal-content {
        background: var(--card-bg);
        margin: 10% auto;
        padding: 30px;
        border-radius: 20px;
        max-width: 500px;
        position: relative;
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.5);
        border: 1px solid var(--border-color);
    }
    
    .close {
        position: absolute;
        top: 15px;
        right: 20px;
        font-size: 28px;
        cursor: pointer;
        color: var(--gray);
    }
    
    .coin-options {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-top: 20px;
    }
    
    .coin-option {
        padding: 15px;
        background: var(--input-bg);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        color: var(--dark);
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
    }
    
    .coin-option:hover {
        background: rgba(67, 97, 238, 0.2);
        transform: translateY(-3px);
    }
    
    #payment-section {
        margin-top: 30px;
        text-align: center;
        animation: fadeIn 0.5s ease;
    }
    
    #qr-code {
        max-width: 250px;
        margin: 20px auto;
        display: block;
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    
    .hidden {
        display: none;
    }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    
    <!-- Auth Section -->
    <div id="auth-section" class="section active">
        <div class="container">
            <div class="auth-card">
                <div class="auth-header">
                    <h2 class="card-title" id="auth-title">Welcome to StartupPlatform</h2>
                </div>
                <div class="auth-body">
                    <form id="login-form">
                        <div class="form-group">
                            <label for="login-email">Email</label>
                            <input type="email" id="login-email" class="form-control" placeholder="Enter your email" required>
                        </div>
                        <div class="form-group">
                            <label for="login-password">Password</label>
                            <input type="password" id="login-password" class="form-control" placeholder="Enter your password" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-glow" style="width: 100%;">Login</button>
                        <p class="error-message" id="login-error"></p>
                    </form>
                    
                    <form id="register-form" class="hidden">
                        <div class="form-group">
                            <label for="register-name">Full Name</label>
                            <input type="text" id="register-name" class="form-control" placeholder="Enter your full name" required>
                        </div>
                        <div class="form-group">
                            <label for="register-email">Email</label>
                            <input type="email" id="register-email" class="form-control" placeholder="Enter your email" required>
                        </div>
                        <div class="form-group">
                            <label for="register-password">Password (min 6 characters)</label>
                            <input type="password" id="register-password" class="form-control" placeholder="Create a password" required>
                        </div>
                        <div class="form-group">
                            <label for="user-type">I am a:</label>
                            <select id="user-type" class="form-control" required>
                                <option value="">Select account type</option>
                                <option value="Founder">Founder</option>
                                <option value="Investor">Investor</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary btn-glow" style="width: 100%;">Create Account</button>
                        <p class="error-message" id="register-error"></p>
                    </form>
                </div>
                <div class="auth-footer">
                    <p id="auth-toggle">
                        <span id="auth-toggle-text">Don't have an account?</span> 
                        <a href="#" id="show-register" class="auth-toggle">Register</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- App Section -->
    <div id="app-section" class="section">
        <header>
            <div class="container">
                <div class="header-content">
                    <div class="logo">StartupPlatform</div>
                    <nav class="desktop-nav">
                        <ul>
                            <li><a href="#" class="nav-link active" data-target="dashboard"><i class="fas fa-home"></i> Dashboard</a></li>
                            <li><a href="#" class="nav-link" data-target="dm"><i class="fas fa-comments"></i> Messages</a></li>
                            <li><a href="#" class="nav-link" data-target="networking"><i class="fas fa-users"></i> Networking</a></li>
                            <li><a href="#" class="nav-link" data-target="cash"><i class="fas fa-wallet"></i> Wallet</a></li>
                        </ul>
                    </nav>
                    <div class="user-info">
                        <div class="avatar" id="user-avatar">U</div>
                        <div>
                            <span id="user-name">User</span>
                            <span class="user-type" id="user-type-display">Type</span>
                        </div>
                        <button id="logout-btn" class="btn btn-outline">Logout</button>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Mobile Navigation -->
        <nav class="mobile-nav">
            <ul>
                <li><a href="#" class="nav-link active" data-target="dashboard"><i class="fas fa-home"></i><span>Home</span></a></li>
                <li><a href="#" class="nav-link" data-target="dm"><i class="fas fa-comments"></i><span>Messages</span></a></li>
                <li><a href="#" class="nav-link" data-target="networking"><i class="fas fa-users"></i><span>Network</span></a></li>
                <li><a href="#" class="nav-link" data-target="cash"><i class="fas fa-wallet"></i><span>Wallet</span></a></li>
            </ul>
        </nav>
        
        <div class="container">
            <!-- Dashboard View -->
            <div id="dashboard" class="section active">
                <!-- Founder Dashboard -->
                <div id="founder-dashboard">
                    <div class="hero-text">
                        <h2>Founder's Hub</h2>
                        <p>Connect, collaborate, and grow your startup</p>
                    </div>
                    
                    <div class="card">
                        <div class="notice">
                            <p><i class="fas fa-lightbulb"></i> Be friendly. Collaborate. Grow together.</p>
                        </div>
                    </div>
                    
                    <div class="dashboard-grid">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-pen"></i> Share Your Experience</h3>
                            </div>
                            <div class="card-body">
                                <form id="post-form">
                                    <div class="form-group">
                                        <input type="text" id="post-title" class="form-control" placeholder="Title of your lesson" required>
                                    </div>
                                    <div class="form-group">
                                        <textarea id="post-content" class="form-control" placeholder="Share your experience or lesson learned..." rows="4" required></textarea>
                                    </div>
                                    <button type="submit" class="btn btn-founder">Post Lesson</button>
                                </form>
                                
                                <div class="mt-4">
                                    <h4>Community Posts</h4>
                                    <div id="posts-list" class="posts-container">
                                        <div class="loader" id="posts-loader"></div>
                                        <div id="posts-content"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-graduation-cap"></i> Business Registration Types</h3>
                            </div>
                            <div class="card-body">
                                <div class="video-container">
                                    <iframe src="https://www.youtube.com/embed/7DqYkL7M3u8" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                </div>
                                <p class="mt-3">Understanding different business structures: LLC, C-Corp, S-Corp</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Investor Dashboard -->
                <div id="investor-dashboard">
                    <div class="hero-text">
                        <h2>Investor Portal</h2>
                        <p>Discover, invest, and grow your portfolio</p>
                    </div>
                    
                    <div class="card">
                        <div class="notice">
                            <p><i class="fas fa-chart-line"></i> You earn dividends from profits, not capital growth</p>
                        </div>
                    </div>
                    
                    <div class="dashboard-grid">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-store"></i> Founders Marketplace</h3>
                            </div>
                            <div class="card-body">
                                <div class="search-bar">
                                    <input type="text" id="search-founders" placeholder="Search founders...">
                                    <button id="search-founders-btn"><i class="fas fa-search"></i></button>
                                </div>
                                <div id="founders-list" class="networking-grid">
                                    <div class="loader" id="founders-loader"></div>
                                    <div id="founders-content"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="right-column">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fas fa-chart-line"></i> Investment Strategies</h3>
                                </div>
                                <div class="card-body">
                                    <div class="video-container">
                                        <iframe src="https://www.youtube.com/embed/6ZfuNTqbHE8" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                    </div>
                                    <p class="mt-3">Understanding investment strategies for startup growth</p>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fas fa-lightbulb"></i> Founder Insights</h3>
                                </div>
                                <div class="card-body">
                                    <div id="investor-posts-list" class="posts-container">
                                        <div class="loader" id="investor-posts-loader"></div>
                                        <div id="investor-posts-content"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- DM Tab -->
            <div id="dm" class="section">
                <div class="hero-text">
                    <h2>Messages</h2>
                    <p>Connect and collaborate with your network</p>
                </div>
                
                <div class="dm-container">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fas fa-comments"></i> Direct Messages</h3>
                        </div>
                        <div class="card-body">
                            <div class="search-bar">
                                <input type="text" id="search-contacts" placeholder="Search contacts...">
                                <button id="search-contacts-btn"><i class="fas fa-search"></i></button>
                            </div>
                            <div id="contacts-list" class="dm-list">
                                <div class="loader" id="contacts-loader"></div>
                                <div id="contacts-content"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title" id="dm-conversation-title"><i class="fas fa-comment-dots"></i> Conversation</h3>
                        </div>
                        <div class="card-body">
                            <div id="dm-conversation" class="dm-content">
                                <div class="message-bubble received-message">
                                    <div>Select a contact to start chatting!</div>
                                </div>
                            </div>
                            <div class="message-input-container">
                                <input type="text" id="dm-message-input" class="message-input" placeholder="Type your message...">
                                <button id="send-message-btn" class="send-btn">Send</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Networking Tab -->
            <div id="networking" class="section">
                <div class="hero-text">
                    <h2>Networking</h2>
                    <p>Connect with founders and investors</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-users"></i> Networking Hub</h3>
                    </div>
                    <div class="card-body">
                        <div class="search-bar">
                            <input type="text" id="search-users" placeholder="Search by name...">
                            <button id="search-users-btn"><i class="fas fa-search"></i></button>
                        </div>
                        
                        <div id="users-list" class="networking-grid">
                            <div class="loader" id="users-loader"></div>
                            <div id="users-content"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Cash Tab --><!-- Cash Tab -->
<div id="cash" class="section">
    <div class="hero-text">
        <h2>Wallet</h2>
        <p>Manage your startup coins</p>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3 class="card-title"><i class="fas fa-wallet"></i> Your Balance</h3>
        </div>
        <div class="card-body">
            <!-- Dynamic balance display -->
            <div class="balance-display" id="balance-display">Loading...</div>
            <button class="btn btn-primary btn-glow">Buy Coins</button>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3 class="card-title"><i class="fas fa-history"></i> Transaction History</h3>
        </div>
        <div class="card-body">
            <ul id="transaction-history" class="user-list">
                <!-- Transactions will appear here -->
            </ul>
        </div>
    </div>
</div>
           <!-- Add this modal structure at the bottom of the body (before particles.js script) -->
<div id="payment-modal" class="modal hidden">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h3>Buy Startup Coins</h3>
        <div class="coin-options">
            <button data-amount="100" class="coin-option">100 Coins (â‚¹100)</button>
            <button data-amount="1000" class="coin-option">1000 Coins (â‚¹1000)</button>
            <button data-amount="10000" class="coin-option">10,000 Coins (â‚¹10,000)</button>
            <button data-amount="100000" class="coin-option">100,000 Coins (â‚¹100,000)</button>
            <button data-amount="1000000" class="coin-option">1,000,000 Coins (â‚¹1,000,000)</button>
        </div>
        <div id="payment-section" class="hidden">
            <p>Complete payment to receive <strong id="coins-amount">0</strong> coins</p>
            <a id="payment-link" href="#" target="_blank" class="btn btn-primary">
                <i class="fas fa-external-link-alt"></i> Complete Payment
            </a>
            <p class="mt-3">After payment, click below:</p>
            <button id="verify-payment" class="btn btn-outline">
                <i class="fas fa-sync-alt"></i> Verify Payment
            </button>
            <div id="payment-status"></div>
        </div>
    </div>
</div>

    <!-- Particles.js -->
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    
    <script>
    // Initialize particles.js
    particlesJS('particles-js', {
        particles: {
            number: { value: 80, density: { enable: true, value_area: 800 } },
            color: { value: "#ffffff" },
            shape: { type: "circle", stroke: { width: 0, color: "#000000" } },
            opacity: { value: 0.1, random: true },
            size: { value: 3, random: true },
            line_linked: {
                enable: true,
                distance: 150,
                color: "#ffffff",
                opacity: 0.05,
                width: 1
            },
            move: {
                enable: true,
                speed: 2,
                direction: "none",
                random: true,
                straight: false,
                out_mode: "out",
                bounce: false
            }
        },
        interactivity: {
            detect_on: "canvas",
            events: {
                onhover: { enable: true, mode: "repulse" },
                onclick: { enable: true, mode: "push" },
                resize: true
            }
        },
        retina_detect: true
    });

    // Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyDriQPKMdRHKKRzlPVXxCCKVgp5EbFOSNg",
        authDomain: "grindpay.firebaseapp.com",
        projectId: "grindpay",
        storageBucket: "grindpay.appspot.com",
        messagingSenderId: "366294485530",
        appId: "1:366294485530:web:477d43906292f347d81fa3",
        measurementId: "G-C6TYPKSXGP"
    };

     firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // State
    let currentUser = null;
    let currentUserData = null;
    let selectedContact = null;
    let messagesListener = null;
    let selectedAmount = 0;
    let currentBalance = null;

    // Initialize after DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        // Get DOM elements
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const authToggle = document.getElementById('auth-toggle');
        const authTitle = document.getElementById('auth-title');
        const logoutBtn = document.getElementById('logout-btn');
        const showRegister = document.getElementById('show-register');
        const postForm = document.getElementById('post-form');
        const sendMessageBtn = document.getElementById('send-message-btn');
        const dmMessageInput = document.getElementById('dm-message-input');
        const buyCoinsBtn = document.querySelector('.btn.btn-primary.btn-glow');
        const modal = document.getElementById('payment-modal');
        const closeBtn = document.querySelector('.close');
        const coinOptions = document.querySelectorAll('.coin-option');
        const paymentSection = document.getElementById('payment-section');
        const paymentAmount = document.getElementById('payment-amount');
        const confirmPaymentBtn = document.getElementById('confirm-payment');
        
        // Modal functionality
        buyCoinsBtn.addEventListener('click', () => {
            modal.classList.remove('hidden');
        });
        
        closeBtn.addEventListener('click', () => {
            modal.classList.add('hidden');
            paymentSection.classList.add('hidden');
        });
        
        window.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.add('hidden');
                paymentSection.classList.add('hidden');
            }
        });
        
        // Coin selection
        coinOptions.forEach(option => {
            option.addEventListener('click', () => {
                selectedAmount = parseInt(option.dataset.amount);
                paymentAmount.textContent = selectedAmount;
                paymentSection.classList.remove('hidden');
                
                // Scroll to payment section
                paymentSection.scrollIntoView({ behavior: 'smooth' });
            });
        });
        
        // Payment confirmation
         confirmPaymentBtn.addEventListener('click', async () => {
            if (selectedAmount === 0) {
                alert('Please select a coin amount first');
                return;
            }
            
          try {
                // Add transaction to Firestore
                await db.collection('transactions').add({
                    userId: currentUser.uid,
                    amount: selectedAmount,
                    type: 'deposit',
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    description: `Purchased ${selectedAmount} coins`
                });
                
                // Update user balance in Firestore
                const newBalance = currentBalance + selectedAmount;
                await db.collection('users').doc(currentUser.uid).update({
                    balance: newBalance
                });
                
                // Update UI
                currentBalance = newBalance;
                
                // FIX: Check if balance display exists before updating
                const balanceDisplay = document.querySelector('.balance-display');
                if (balanceDisplay) {
                    balanceDisplay.textContent = newBalance.toLocaleString();
                }
                
                // Add to transaction history
                const transactionList = document.querySelector('.transaction-history .user-list');
                if (transactionList) {
                    const newTransaction = document.createElement('li');
                    newTransaction.className = 'transaction-item';
                    newTransaction.innerHTML = `
                        <div>
                            <strong>Coins Purchased</strong>
                            <p>Just now</p>
                        </div>
                        <span class="transaction-positive">+${selectedAmount}</span>
                    `;
                    transactionList.prepend(newTransaction);
                }
                
                // Close modal and reset
                modal.classList.add('hidden');
                paymentSection.classList.add('hidden');
                selectedAmount = 0;
                
                alert(`Successfully added ${selectedAmount} coins to your account!`);
            } catch (error) {
                console.error('Payment processing error:', error);
                alert('Error processing payment. Please try again.');
            }
        });

        // Authentication tab switching
        showRegister.addEventListener('click', function(e) {
            e.preventDefault();
            loginForm.classList.add('hidden');
            registerForm.classList.remove('hidden');
            authTitle.textContent = 'Create Account';
            document.getElementById('auth-toggle-text').textContent = 'Already have an account?';
            showRegister.textContent = 'Login';
            showRegister.id = 'show-login';
            
            // Add listener for the new login link
            document.getElementById('show-login').addEventListener('click', function(e) {
                e.preventDefault();
                registerForm.classList.add('hidden');
                loginForm.classList.remove('hidden');
                authTitle.textContent = 'Welcome to StartupPlatform';
                document.getElementById('auth-toggle-text').textContent = 'Don\'t have an account?';
                document.getElementById('show-login').textContent = 'Register';
                document.getElementById('show-login').id = 'show-register';
            });
        });

        // Login
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    currentUser = userCredential.user;
                    loadUserData();
                })
                .catch((error) => {
                    document.getElementById('login-error').textContent = error.message;
                });
        });

        // Registration
        registerForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const type = document.getElementById('user-type').value;
            
            // Create user in Firebase Auth
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Add user to Firestore
                    return db.collection('users').doc(userCredential.user.uid).set({
                        uid: userCredential.user.uid,
                        name: name,
                        email: email,
                        type: type,
                        balance: 1250, // Initial balance
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        bio: type + " at " + name + "'s company",
                        postCount: 0
                    });
                })
                .then(() => {
                    currentUser = auth.currentUser;
                    loadUserData();
                })
                .catch((error) => {
                    document.getElementById('register-error').textContent = error.message;
                });
        });

        // Logout
        logoutBtn.addEventListener('click', () => {
            auth.signOut().then(() => {
                currentUser = null;
                currentUserData = null;
                document.getElementById('auth-section').classList.add('active');
                document.getElementById('app-section').classList.remove('active');
                
                // Clean up listeners
                if (messagesListener) {
                    messagesListener();
                    messagesListener = null;
                }
            });
        });

        // Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const target = link.getAttribute('data-target');
                
                // Update active nav link
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                link.classList.add('active');
                
                // Show target section
                document.querySelectorAll('.container > .section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById(target).classList.add('active');
                
                // Load data for the section
                if (target === 'dashboard') {
                    loadDashboardData();
                } else if (target === 'networking') {
                    loadUsers();
                } else if (target === 'dm') {
                    loadConversationUsers();
                }
            });
        });

        // Create new post (for founders)
        postForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const title = document.getElementById('post-title').value;
            const content = document.getElementById('post-content').value;
            
            if (!currentUser || !currentUserData) return;
            
            // Add post to Firestore
            db.collection('posts').add({
                title: title,
                content: content,
                authorId: currentUser.uid,
                authorName: currentUserData.name,
                authorType: currentUserData.type,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            })
            .then(() => {
                // Clear form
                postForm.reset();
                
                // Update user's post count
                db.collection('users').doc(currentUser.uid).update({
                    postCount: firebase.firestore.FieldValue.increment(1)
                });
                
                // Reload posts
                loadPosts();
                loadInvestorPosts();
            })
            .catch((error) => {
                console.error('Error adding post: ', error);
            });
        });

        // Send message
        sendMessageBtn.addEventListener('click', () => {
            sendMessage();
        });
        
        dmMessageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        // Listen for auth state changes
        auth.onAuthStateChanged(user => {
            if (user) {
                currentUser = user;
                loadUserData();
            } else {
                currentUser = null;
                currentUserData = null;
                document.getElementById('auth-section').classList.add('active');
                document.getElementById('app-section').classList.remove('active');
            }
        });
    });

    // Get avatar letter safely
    function getAvatarLetter(name) {
        if (!name) return '?';
        if (typeof name !== 'string') return '?';
        if (name.trim().length === 0) return '?';
        return name.trim().charAt(0).toUpperCase();
    }

// Load user data from Firestore
  function loadUserData() {
    if (!currentUser) return;
    
    db.collection('users').doc(currentUser.uid).get()
        .then(doc => {
            if (doc.exists) {
                currentUserData = doc.data();
                currentBalance = currentUserData.balance || 0;
                
                // Update UI with user data
                document.getElementById('user-name').textContent = currentUserData.name || 'User';
                document.getElementById('user-type-display').textContent = currentUserData.type || 'Type';
                document.getElementById('user-avatar').textContent = getAvatarLetter(currentUserData.name);
                
                // Update balance display
                document.getElementById('balance-display').textContent = 
                    currentBalance.toLocaleString();
                
                // Also update transaction history
                loadTransactionHistory();
                
                // Show appropriate dashboard
                if (currentUserData.type === 'Founder') {
                    document.getElementById('founder-dashboard').style.display = 'block';
                    document.getElementById('investor-dashboard').style.display = 'none';
                } else if (currentUserData.type === 'Investor') {
                    document.getElementById('investor-dashboard').style.display = 'block';
                    document.getElementById('founder-dashboard').style.display = 'none';
                }
                
                // Switch to app view
                document.getElementById('auth-section').classList.remove('active');
                document.getElementById('app-section').classList.add('active');
            }
        })
        .catch(error => {
            console.error('Error loading user data:', error);
        });
}
        
        
        db.collection('users').doc(currentUser.uid).get()
            .then(doc => {
                if (doc.exists) {
                    currentUserData = doc.data();
                    
                    // Set balance from Firestore
                    currentBalance = currentUserData.balance || 1250;
                    
                    // Update UI with user data
                    document.getElementById('user-name').textContent = currentUserData.name || 'User';
                    document.getElementById('user-type-display').textContent = currentUserData.type || 'Type';
                    document.getElementById('user-avatar').textContent = getAvatarLetter(currentUserData.name);
                    
                    // FIX: Check if element exists before updating
                    const balanceDisplay = document.querySelector('.balance-display');
                    if (balanceDisplay) {
                        balanceDisplay.textContent = currentBalance.toLocaleString();
                    }
                    // Show appropriate dashboard
                    if (currentUserData.type === 'Founder') {
                        document.getElementById('founder-dashboard').style.display = 'block';
                        document.getElementById('investor-dashboard').style.display = 'none';
                    } else if (currentUserData.type === 'Investor') {
                        document.getElementById('investor-dashboard').style.display = 'block';
                        document.getElementById('founder-dashboard').style.display = 'none';
                    }
                    
                    // Load dashboard data
                    loadDashboardData();
                    
                    // Switch to app view
                    document.getElementById('auth-section').classList.remove('active');
                    document.getElementById('app-section').classList.add('active');
                }
            })
            .catch(error => {
                console.error('Error loading user data:', error);
            });
    

    // Load dashboard data based on user type
    function loadDashboardData() {
        if (currentUserData) {
            if (currentUserData.type === 'Founder') {
                loadPosts();
            } else if (currentUserData.type === 'Investor') {
                loadFounders();
                loadInvestorPosts();
            }
        }
    }

    // Load posts for founders
    function loadPosts() {
        if (!currentUser) return;
        
        const loader = document.getElementById('posts-loader');
        const container = document.getElementById('posts-content');
        
        loader.style.display = 'block';
        container.innerHTML = '';
        
        db.collection('posts')
            .orderBy('createdAt', 'desc')
            .get()
            .then((querySnapshot) => {
                loader.style.display = 'none';
                
                if (querySnapshot.empty) {
                    container.innerHTML = '<p>No posts yet. Be the first to share your experience!</p>';
                    return;
                }
                
                querySnapshot.forEach((doc) => {
                    const post = doc.data();
                    const date = post.createdAt ? post.createdAt.toDate() : new Date();
                    const formattedDate = formatDate(date);
                    
                    const postElement = document.createElement('div');
                    postElement.className = 'post';
                    postElement.innerHTML = `
                        <h4 class="post-title">${post.title || 'Untitled'}</h4>
                        <p class="post-author"><i class="fas fa-user"></i> By ${post.authorName || 'Anonymous'} â€¢ ${formattedDate}</p>
                        <p class="post-content">${post.content || ''}</p>
                    `;
                    
                    container.appendChild(postElement);
                });
            })
            .catch((error) => {
                loader.style.display = 'none';
                container.innerHTML = '<p>Error loading posts. Please try again.</p>';
                console.error('Posts error:', error);
            });
    }

    // Load posts for investor dashboard
    function loadInvestorPosts() {
        if (!currentUser) return;
        
        const loader = document.getElementById('investor-posts-loader');
        const container = document.getElementById('investor-posts-content');
        
        if (!loader || !container) return;
        
        loader.style.display = 'block';
        container.innerHTML = '';
        
        db.collection('posts')
            .orderBy('createdAt', 'desc')
            .get()
            .then((querySnapshot) => {
                loader.style.display = 'none';
                
                if (querySnapshot.empty) {
                    container.innerHTML = '<p>No posts from founders yet.</p>';
                    return;
                }
                
                querySnapshot.forEach((doc) => {
                    const post = doc.data();
                    const date = post.createdAt ? post.createdAt.toDate() : new Date();
                    const formattedDate = formatDate(date);
                    
                    const postElement = document.createElement('div');
                    postElement.className = 'post';
                    postElement.innerHTML = `
                        <h4 class="post-title">${post.title || 'Untitled'}</h4>
                        <p class="post-author"><i class="fas fa-user"></i> By ${post.authorName || 'Anonymous'} â€¢ ${formattedDate}</p>
                        <p class="post-content">${post.content || ''}</p>
                    `;
                    
                    container.appendChild(postElement);
                });
            })
            .catch((error) => {
                if (loader) loader.style.display = 'none';
                if (container) container.innerHTML = '<p>Error loading posts. Please try again.</p>';
                console.error('Investor posts error:', error);
            });
    }

    // Load founders for investors
    function loadFounders() {
        if (!currentUser) return;
        
        const loader = document.getElementById('founders-loader');
        const container = document.getElementById('founders-content');
        
        loader.style.display = 'block';
        container.innerHTML = '';
        
        db.collection('users')
            .where('type', '==', 'Founder')
            .get()
            .then((querySnapshot) => {
                loader.style.display = 'none';
                
                if (querySnapshot.empty) {
                    container.innerHTML = '<p>No founders found.</p>';
                    return;
                }
                
                querySnapshot.forEach((doc) => {
                    const user = doc.data();
                    const userElement = document.createElement('div');
                    userElement.className = 'user-card';
                    userElement.innerHTML = `
                        <div class="user-card-header">
                            <div class="avatar">${getAvatarLetter(user.name)}</div>
                            <div class="user-card-info">
                                <h4>${user.name || 'Unknown User'}</h4>
                                <p>${user.email || ''}</p>
                            </div>
                        </div>
                        <div class="user-card-content">
                            <p>Bio: ${user.bio || 'No bio available'}</p>
                            <p>Posts: ${user.postCount || 0}</p>
                        </div>
                        <div class="user-card-actions">
                            <button class="btn btn-outline" onclick="startConversation('${user.uid || ''}', '${user.name || 'Unknown'}')">
                                <i class="fas fa-comment"></i> Message
                            </button>
                        </div>
                    `;
                    
                    container.appendChild(userElement);
                });
            })
            .catch((error) => {
                loader.style.display = 'none';
                container.innerHTML = '<p>Error loading founders. Please try again.</p>';
                console.error('Founders error:', error);
            });
    }

    // Load users for networking
    function loadUsers() {
        if (!currentUser) return;
        
        const loader = document.getElementById('users-loader');
        const container = document.getElementById('users-content');
        
        loader.style.display = 'block';
        container.innerHTML = '';
        
        db.collection('users')
            .get()
            .then((querySnapshot) => {
                loader.style.display = 'none';
                
                if (querySnapshot.empty) {
                    container.innerHTML = '<p>No users found.</p>';
                    return;
                }
                
                querySnapshot.forEach((doc) => {
                    const user = doc.data();
                    if (user.uid === currentUser.uid) return; // Skip current user
                    
                    const userElement = document.createElement('div');
                    userElement.className = 'user-card';
                    userElement.innerHTML = `
                        <div class="user-card-header">
                            <div class="avatar">${getAvatarLetter(user.name)}</div>
                            <div class="user-card-info">
                                <h4>${user.name || 'Unknown User'} <span class="user-badge ${user.type === 'Founder' ? 'founder-badge' : 'investor-badge'}">${user.type || 'Unknown'}</span></h4>
                                <p>${user.email || ''}</p>
                            </div>
                        </div>
                        <div class="user-card-actions">
                            <button class="btn btn-outline" onclick="startConversation('${user.uid || ''}', '${user.name || 'Unknown'}')">
                                <i class="fas fa-comment"></i> Message
                            </button>
                        </div>
                    `;
                    
                    container.appendChild(userElement);
                });
            })
            .catch((error) => {
                loader.style.display = 'none';
                container.innerHTML = '<p>Error loading users. Please try again.</p>';
                console.error('Users error:', error);
            });
    }

    // Load contacts for DM
    function loadConversationUsers() {
        const usersSet = new Set();

        db.collection("messages")
            .where("senderId", "==", currentUser.uid)
            .get()
            .then(sentSnapshot => {
                sentSnapshot.forEach(doc => {
                    usersSet.add(doc.data().receiverId);
                });

                return db.collection("messages")
                    .where("receiverId", "==", currentUser.uid)
                    .get();
            })
            .then(receivedSnapshot => {
                receivedSnapshot.forEach(doc => {
                    usersSet.add(doc.data().senderId);
                });

                const userIds = Array.from(usersSet);

                // Now fetch user profiles
                if (userIds.length === 0) return;

                db.collection("users")
                    .where(firebase.firestore.FieldPath.documentId(), "in", userIds)
                    .get()
                    .then(userSnapshot => {
                        const contactsList = document.getElementById("contacts-list");
                        contactsList.innerHTML = "";

                        userSnapshot.forEach(userDoc => {
                            const user = userDoc.data();
                            const div = document.createElement("div");
                            div.textContent = user.name;
                            div.classList.add("contact-item");
                            div.onclick = () => startConversation(userDoc.id, user.name);

                            contactsList.appendChild(div);
                        });
                    });
            })
            .catch(error => {
                console.error("Error loading conversation users:", error);
            });
    }

    // Start conversation with a user
    function startConversation(userId, userName) {
        if (!currentUser || !userId) return;
        
        selectedContact = {
            uid: userId,
            name: userName
        };
        
        // Update UI
        document.getElementById('dm-conversation-title').textContent = `Conversation with ${userName}`;
        
        // Clear existing messages
        document.getElementById('dm-conversation').innerHTML = '';
        
        // Load messages
        loadMessages(userId);
        
        // Switch to DM tab
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        document.querySelector(`.nav-link[data-target="dm"]`).classList.add('active');
        
        document.querySelectorAll('.container > .section').forEach(section => {
            section.classList.remove('active');
        });
        document.getElementById('dm').classList.add('active');
    }

    // Load messages for a conversation
    function loadMessages(userId) {
        if (!currentUser || !userId) return;
        
        // Clean up previous listener
        if (messagesListener) {
            messagesListener();
        }
        
        // Get conversation ID (sorted for consistency)
        const conversationId = [currentUser.uid, userId].sort().join('_');
        
        // Listen for messages in real-time
        messagesListener = db.collection('messages')
            .where('conversationId', '==', conversationId)
            .orderBy('createdAt', 'asc')
            .onSnapshot((querySnapshot) => {
                const dmConversation = document.getElementById('dm-conversation');
                dmConversation.innerHTML = '';
                
                if (querySnapshot.empty) {
                    dmConversation.innerHTML = `
                        <div class="message-bubble received-message">
                            <div>Start a conversation with ${selectedContact.name}!</div>
                        </div>
                    `;
                    return;
                }
                
                querySnapshot.forEach((doc) => {
                    const message = doc.data();
                    const isCurrentUser = message.senderId === currentUser.uid;
                    const date = message.createdAt ? message.createdAt.toDate() : new Date();
                    const formattedTime = formatTime(date);
                    
                    const messageElement = document.createElement('div');
                    messageElement.className = `message-bubble ${isCurrentUser ? 'sent-message' : 'received-message'}`;
                    messageElement.innerHTML = `
                        <div>${message.content || ''}</div>
                        <div class="message-time">${formattedTime}</div>
                    `;
                    
                    dmConversation.appendChild(messageElement);
                });
                
                // Scroll to bottom
                dmConversation.scrollTop = dmConversation.scrollHeight;
            }, (error) => {
                console.error('Error loading messages:', error);
                if (error.code === 'failed-precondition') {
                    console.log('You need to create a Firestore index for this query. Follow the link in the error message to create it.');
                }
            });
    }

    // Send message
    function sendMessage() {
        if (!currentUser || !selectedContact || !document.getElementById('dm-message-input').value.trim()) return;
        
        // Get conversation ID (sorted for consistency)
        const conversationId = [currentUser.uid, selectedContact.uid].sort().join('_');
        
        // Add message to Firestore
        db.collection('messages').add({
            content: document.getElementById('dm-message-input').value.trim(),
            senderId: currentUser.uid,
            receiverId: selectedContact.uid,
            conversationId: conversationId,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        })
        .then(() => {
            // Clear input
            document.getElementById('dm-message-input').value = '';
        })
        .catch((error) => {
            console.error('Error sending message: ', error);
        });
    }

    // Utility functions
    function formatDate(date) {
        return date.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'short',
            day: 'numeric'
        });
    }
    
    function formatTime(date) {
        return date.toLocaleTimeString('en-US', {
            hour: '2-digit',
            minute: '2-digit'
        });
    }
    function loadTransactionHistory() {
    if (!currentUser) return;
    
    const transactionList = document.getElementById('transaction-history');
    transactionList.innerHTML = '<div class="loader">Loading transactions...</div>';
    
    db.collection('transactions')
        .where('userId', '==', currentUser.uid)
        .orderBy('timestamp', 'desc')
        .get()
        .then(querySnapshot => {
            transactionList.innerHTML = '';
            
            if (querySnapshot.empty) {
                transactionList.innerHTML = '<li class="transaction-item">No transactions yet</li>';
                return;
            }
            
            querySnapshot.forEach(doc => {
                const transaction = doc.data();
                const date = transaction.timestamp.toDate();
                const formattedDate = `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;
                
                const li = document.createElement('li');
                li.className = 'transaction-item';
                li.innerHTML = `
                    <div>
                        <strong>${transaction.description || 'Transaction'}</strong>
                        <p>${formattedDate}</p>
                    </div>
                    <span class="${transaction.type === 'deposit' ? 
                        'transaction-positive' : 'transaction-negative'}">
                        ${transaction.type === 'deposit' ? '+' : '-'}${transaction.amount}
                    </span>
                `;
                
                transactionList.appendChild(li);
            });
        })
        .catch(error => {
            console.error('Error loading transactions:', error);
            transactionList.innerHTML = '<li class="transaction-item">Error loading transactions</li>';
        });
}
</script>
</body>
</html>
